# [0125. å¼‚æ„æšä¸¾](https://github.com/tnotesjs/TNotes.typescript/tree/main/notes/0125.%20%E5%BC%82%E6%9E%84%E6%9E%9A%E4%B8%BE)

<!-- region:toc -->

- [1. ğŸ¯ æœ¬èŠ‚å†…å®¹](#1--æœ¬èŠ‚å†…å®¹)
- [2. ğŸ«§ è¯„ä»·](#2--è¯„ä»·)
- [3. ğŸ” TS å®˜æ–¹å¯¹äºå¼‚æ„æšä¸¾çš„è¯´æ˜](#3--ts-å®˜æ–¹å¯¹äºå¼‚æ„æšä¸¾çš„è¯´æ˜)
- [4. ğŸ¤” ä»€ä¹ˆæ˜¯å¼‚æ„æšä¸¾ï¼Ÿ](#4--ä»€ä¹ˆæ˜¯å¼‚æ„æšä¸¾)
- [5. ğŸ¤” å¼‚æ„æšä¸¾çš„åˆå§‹åŒ–æœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ](#5--å¼‚æ„æšä¸¾çš„åˆå§‹åŒ–æœ‰ä»€ä¹ˆé™åˆ¶)
- [6. ğŸ†š å¼‚æ„æšä¸¾ vs çº¯æšä¸¾](#6--å¼‚æ„æšä¸¾-vs-çº¯æšä¸¾)
- [7. ğŸ¤” å¼‚æ„æšä¸¾çš„ä½¿ç”¨å»ºè®®æ˜¯ï¼Ÿ](#7--å¼‚æ„æšä¸¾çš„ä½¿ç”¨å»ºè®®æ˜¯)
- [8. ğŸ”— å¼•ç”¨](#8--å¼•ç”¨)

<!-- endregion:toc -->

## 1. ğŸ¯ æœ¬èŠ‚å†…å®¹

- å¼‚æ„æšä¸¾çš„å®šä¹‰
- æ•°å­—å’Œå­—ç¬¦ä¸²æ··åˆä½¿ç”¨çš„è§„åˆ™
- åˆå§‹åŒ–é™åˆ¶ï¼ˆæ ¸å¿ƒè€ƒç‚¹ï¼‰
- éƒ¨åˆ†åå‘æ˜ å°„çš„è¡Œä¸º
- æœ€ä½³å®è·µä¸æ›¿ä»£æ–¹æ¡ˆ

## 2. ğŸ«§ è¯„ä»·

å¼‚æ„æšä¸¾ï¼ˆHeterogeneous Enumï¼‰å…è®¸ TypeScript æšä¸¾ç±»å‹ä¸­åŒæ—¶åŒ…å«â€œæ•°å­—â€å’Œâ€œå­—ç¬¦ä¸²â€æˆå‘˜ã€‚è™½ç„¶æŠ€æœ¯ä¸Šå¯è¡Œï¼Œä½† TypeScript å®˜æ–¹ä¸æ¨èä½¿ç”¨ ã€‚

é€šå¸¸åªåœ¨éœ€è¦å…¼å®¹æ—§çš„è¿è¡Œæ—¶ç³»ç»Ÿï¼ˆå¦‚æ—§ API è¿”å›æ•°å­—ï¼Œæ–° API éœ€è¦å­—ç¬¦ä¸²ï¼‰æ—¶æ‰ä¼šè€ƒè™‘ä½¿ç”¨ã€‚

## 3. ğŸ” TS å®˜æ–¹å¯¹äºå¼‚æ„æšä¸¾çš„è¯´æ˜

Heterogeneous enums - å¼‚æ„æšä¸¾

Technically enums can be mixed with string and numeric members, but itâ€™s not clear why you would ever want to do so:

ä»æŠ€æœ¯ä¸Šè®²ï¼Œæšä¸¾å¯ä»¥æ··åˆä½¿ç”¨å­—ç¬¦ä¸²å’Œæ•°å­—æˆå‘˜ï¼Œä½†è¿™æ ·åšçš„å¥½å¤„å¹¶ä¸æ˜æ˜¾ï¼š

```ts
enum BooleanLikeHeterogeneousEnum {
  No = 0,
  Yes = 'YES',
}
```

Unless youâ€™re really trying to take advantage of JavaScriptâ€™s runtime behavior in a clever way, itâ€™s advised that you donâ€™t do this.

é™¤éæ‚¨ç¡®å®æƒ³è¦å·§å¦™åœ°åˆ©ç”¨ JavaScript çš„è¿è¡Œæ—¶è¡Œä¸ºï¼Œå¦åˆ™å»ºè®®ä¸è¦è¿™æ ·åšã€‚

## 4. ğŸ¤” ä»€ä¹ˆæ˜¯å¼‚æ„æšä¸¾ï¼Ÿ

å¼‚æ„æšä¸¾æ˜¯åŒæ—¶åŒ…å«æ•°å­—å’Œå­—ç¬¦ä¸²æˆå‘˜å€¼çš„æšä¸¾ç±»å‹ã€‚

å¼‚æ„æšä¸¾ç¤ºä¾‹ï¼š

```ts
enum Heterogeneous {
  No = 0,
  Yes = 'YES',
}

console.log(Heterogeneous.No) // 0
console.log(Heterogeneous.Yes) // 'YES'
```

ç¼–è¯‘ç»“æœåˆ†æï¼šTypeScript ä¼šä¸ºæ•°å­—æˆå‘˜ç”Ÿæˆåå‘æ˜ å°„ï¼Œä½†å­—ç¬¦ä¸²æˆå‘˜åˆ™ä¸ä¼šã€‚

ç¼–è¯‘åçš„ JavaScriptï¼š

```js
;('use strict')
var Heterogeneous
;(function (Heterogeneous) {
  // æ•°å­—æˆå‘˜ï¼šåŒå‘èµ‹å€¼
  Heterogeneous[(Heterogeneous['No'] = 0)] = 'No'
  // å­—ç¬¦ä¸²æˆå‘˜ï¼šå•å‘èµ‹å€¼
  Heterogeneous['Yes'] = 'YES'
})(Heterogeneous || (Heterogeneous = {}))
console.log(Heterogeneous.No) // 0
console.log(Heterogeneous.Yes) // 'YES'
```

å¼‚æ„æšä¸¾è¡¨ç°å‡ºâ€œéƒ¨åˆ†åå‘æ˜ å°„â€çš„ç‰¹æ€§ï¼šåªæœ‰æ•°å­—æˆå‘˜æ‹¥æœ‰åå‘æ˜ å°„ï¼Œå­—ç¬¦ä¸²æˆå‘˜æ²¡æœ‰ã€‚

```ts
enum Heterogeneous {
  No = 0,
  Yes = 'YES',
}

// âœ… æ•°å­—æˆå‘˜æœ‰åå‘æ˜ å°„
console.log(Heterogeneous['0']) // 'No'

// âŒ å­—ç¬¦ä¸²æˆå‘˜æ— åå‘æ˜ å°„
// console.log(Heterogeneous['YES']) // âŒ æŠ¥é”™
// Element implicitly has an 'any' type because index expression is not of type 'number'.(7015)
```

## 5. ğŸ¤” å¼‚æ„æšä¸¾çš„åˆå§‹åŒ–æœ‰ä»€ä¹ˆé™åˆ¶ï¼Ÿ

å¦‚æœä¸€ä¸ªæšä¸¾æˆå‘˜çš„å‰ä¸€ä¸ªæˆå‘˜æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¯¥æˆå‘˜æ— æ³•è‡ªåŠ¨è·å¾—åˆå§‹å€¼ï¼Œå¿…é¡»æ‰‹åŠ¨èµ‹å€¼ã€‚

è¿™æ˜¯å¼‚æ„æšä¸¾æœ€å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ã€‚TypeScript çš„æšä¸¾è‡ªåŠ¨é€’å¢ç‰¹æ€§ä»…é€‚ç”¨äºæ•°å­—ã€‚

```ts
// âŒ é”™è¯¯ç¤ºä¾‹
enum Problem {
  A = 'A',
  B, // âŒ Error: å­—ç¬¦ä¸²æšä¸¾æˆå‘˜åé¢çš„æˆå‘˜å¿…é¡»åˆå§‹åŒ–
  C = 1,
  D, // âœ… 2 - æ•°å­—æˆå‘˜åé¢å¯ä»¥è‡ªåŠ¨é€’å¢
}
// æŠ¥é”™ä¿¡æ¯: Enum member must have initializer.
```

å»ºè®®å°†æ‰€æœ‰æ•°å­—æˆå‘˜æ”¾åœ¨å‰é¢ï¼Œæˆ–è€…ç¡®ä¿æ¯ä¸ªç´§è·Ÿåœ¨å­—ç¬¦ä¸²åçš„æˆå‘˜éƒ½æœ‰æ˜¾å¼èµ‹å€¼ã€‚

```ts
// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šåˆ†æ®µå®šä¹‰
enum Correct {
  // æ•°å­—éƒ¨åˆ†ï¼ˆå¯ä»¥åˆ©ç”¨è‡ªåŠ¨é€’å¢ï¼‰
  None = 0,
  First, // 1
  Second, // 2

  // å­—ç¬¦ä¸²éƒ¨åˆ†ï¼ˆå¿…é¡»æ˜¾å¼èµ‹å€¼ï¼‰
  Role = 'ADMIN',
  Status = 'ACTIVE',
}

// âœ… æ­£ç¡®ç¤ºä¾‹ï¼šæ˜¾å¼èµ‹å€¼
enum Mixed {
  A = 'A',
  B = 1, // æ˜¾å¼èµ‹å€¼ï¼Œæ‰“æ–­å­—ç¬¦ä¸²é“¾æ¡
  C, // 2 (è‡ªåŠ¨é€’å¢)
}
```

## 6. ğŸ†š å¼‚æ„æšä¸¾ vs çº¯æšä¸¾

| ç‰¹æ€§     | å¼‚æ„æšä¸¾             | çº¯æ•°å­—æšä¸¾ | çº¯å­—ç¬¦ä¸²æšä¸¾ |
| -------- | -------------------- | ---------- | ------------ |
| å€¼ç±»å‹   | æ··åˆ                 | æ•°å­—       | å­—ç¬¦ä¸²       |
| è‡ªåŠ¨é€’å¢ | éƒ¨åˆ†æ”¯æŒï¼ˆä»…æ•°å­—åï¼‰ | å®Œå…¨æ”¯æŒ   | ä¸æ”¯æŒ       |
| åå‘æ˜ å°„ | éƒ¨åˆ†æ”¯æŒï¼ˆä»…æ•°å­—ï¼‰   | æ”¯æŒ       | ä¸æ”¯æŒ       |
| æ¨èåº¦   | ä¸æ¨è               | æ¨è       | æœ€æ¨è       |

å¼‚æ„æšä¸¾æœ‰æ—¶ä¹Ÿä¼šè¢«ç§°ä¸ºæ··åˆæšä¸¾ï¼Œè™½ç„¶å«æ³•ä¸åŒï¼Œä½†æ˜¯æŒ‡ä»£çš„éƒ½æ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚

## 7. ğŸ¤” å¼‚æ„æšä¸¾çš„ä½¿ç”¨å»ºè®®æ˜¯ï¼Ÿ

å°½ç®¡ä¸æ¨èï¼Œä½†åœ¨ç‰¹å®šåœºæ™¯ä¸­å¼‚æ„æšä¸¾å¯èƒ½æ˜¯å¿…è¦çš„å¦¥åã€‚

å…¼å®¹é—ç•™ç³»ç»Ÿï¼šæ¯”å¦‚æ­£åœ¨è¿ç§»ç³»ç»Ÿï¼Œæ—§æ¥å£ä½¿ç”¨æ•°å­—çŠ¶æ€ç ï¼Œè€Œæ–°æ¥å£å€¾å‘äºä½¿ç”¨å¯è¯»æ€§æ›´å¼ºçš„å­—ç¬¦ä¸²æ ‡è¯†ç¬¦æ—¶ã€‚

```ts
enum LegacyStatus {
  // ä¿æŒå‘åå…¼å®¹çš„æ•°å­—ä»£ç 
  Unknown = 0,
  SystemError = 1,

  // æ–°å¢çš„å­—ç¬¦ä¸²ä¸šåŠ¡çŠ¶æ€
  AuthError = 'AUTH_ERROR',
  ValidationError = 'VALIDATION_ERROR',
}
```

é¿å…æ··ç”¨ï¼šæœ€æ¸…æ™°çš„ä»£ç é€šå¸¸æ˜¯å°†æ•°å­—å’Œå­—ç¬¦ä¸²åˆ†å¼€å®šä¹‰ã€‚

```ts
// æ¨èï¼šæ‹†åˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„æšä¸¾
enum StatusCode {
  Unknown = 0,
  Error = 1,
}

enum StatusMessage {
  Unknown = 'UNKNOWN',
  Error = 'ERROR',
}
```

ä½¿ç”¨è”åˆç±»å‹æ›¿ä»£ï¼šå¦‚æœåªæ˜¯ä¸ºäº†ç±»å‹å®‰å…¨ï¼Œä½¿ç”¨è”åˆç±»å‹å¾€å¾€æ¯”å¼‚æ„æšä¸¾æ›´çµæ´»ã€æ›´è½»é‡ã€‚

```ts
// è”åˆç±»å‹
type Status =
  | { type: 'code'; value: number }
  | { type: 'message'; value: string }

function handleStatus(s: Status) {
  if (s.type === 'code') {
    console.log(s.value) // number
  } else {
    console.log(s.value) // string
  }
}
```

## 8. ğŸ”— å¼•ç”¨

- [TypeScript Handbook - Enums](https://www.typescriptlang.org/docs/handbook/enums.html)
- [TypeScript Deep Dive - Heterogeneous Enums](https://basarat.gitbook.io/typescript/type-system/enums#heterogeneous-enums)

# [0035. class ç±»å‹](https://github.com/tnotesjs/TNotes.typescript/tree/main/notes/0035.%20class%20%E7%B1%BB%E5%9E%8B)

<!-- region:toc -->

- [1. ğŸ¯ æœ¬èŠ‚å†…å®¹](#1--æœ¬èŠ‚å†…å®¹)
- [2. ğŸ«§ è¯„ä»·](#2--è¯„ä»·)
- [3. ğŸ¤” ä»€ä¹ˆæ˜¯ TypeScript ä¸­çš„ç±»ï¼ˆclassï¼‰ï¼Ÿ](#3--ä»€ä¹ˆæ˜¯-typescript-ä¸­çš„ç±»class)
- [4. ğŸ¤” å¦‚ä½•å£°æ˜ç±»çš„å±æ€§ç±»å‹ï¼Ÿ](#4--å¦‚ä½•å£°æ˜ç±»çš„å±æ€§ç±»å‹)
- [5. ğŸ¤” TypeScript å¦‚ä½•å¤„ç†æœªåˆå§‹åŒ–çš„ç±»å±æ€§ï¼Ÿ](#5--typescript-å¦‚ä½•å¤„ç†æœªåˆå§‹åŒ–çš„ç±»å±æ€§)
- [6. ğŸ¤” readonly ä¿®é¥°ç¬¦æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ](#6--readonly-ä¿®é¥°ç¬¦æœ‰ä»€ä¹ˆä½œç”¨)
- [7. ğŸ¤” ç±»çš„æ–¹æ³•å¦‚ä½•å£°æ˜ç±»å‹ï¼Ÿ](#7--ç±»çš„æ–¹æ³•å¦‚ä½•å£°æ˜ç±»å‹)
- [8. ğŸ¤” ä»€ä¹ˆæ˜¯å­˜å–å™¨æ–¹æ³•ï¼Ÿ](#8--ä»€ä¹ˆæ˜¯å­˜å–å™¨æ–¹æ³•)
- [9. ğŸ¤” å¦‚ä½•ä½¿ç”¨ implements å…³é”®å­—ï¼Ÿ](#9--å¦‚ä½•ä½¿ç”¨-implements-å…³é”®å­—)
- [10. ğŸ¤” å¦‚ä½•è·å–ç±»çš„è‡ªèº«ç±»å‹ï¼Ÿ](#10--å¦‚ä½•è·å–ç±»çš„è‡ªèº«ç±»å‹)
- [11. ğŸ¤” ä»€ä¹ˆæ˜¯ç»“æ„ç±»å‹åŸåˆ™ï¼Ÿ](#11--ä»€ä¹ˆæ˜¯ç»“æ„ç±»å‹åŸåˆ™)
- [12. ğŸ¤” å¦‚ä½•å®ç°ç±»çš„ç»§æ‰¿ï¼Ÿ](#12--å¦‚ä½•å®ç°ç±»çš„ç»§æ‰¿)
- [13. ğŸ¤” override å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ](#13--override-å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨)
- [14. ğŸ¤” ä»€ä¹ˆæ˜¯å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼Ÿ](#14--ä»€ä¹ˆæ˜¯å¯è®¿é—®æ€§ä¿®é¥°ç¬¦)
- [15. ğŸ¤” å¦‚ä½•ä½¿ç”¨å®ä¾‹å±æ€§çš„ç®€å†™å½¢å¼ï¼Ÿ](#15--å¦‚ä½•ä½¿ç”¨å®ä¾‹å±æ€§çš„ç®€å†™å½¢å¼)
- [16. ğŸ¤” å¦‚ä½•å¤„ç†ç±»çš„é™æ€æˆå‘˜ï¼Ÿ](#16--å¦‚ä½•å¤„ç†ç±»çš„é™æ€æˆå‘˜)
- [17. ğŸ¤” ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»å’ŒæŠ½è±¡æˆå‘˜ï¼Ÿ](#17--ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»å’ŒæŠ½è±¡æˆå‘˜)
- [18. ğŸ¤” å¦‚ä½•å¤„ç†ç±»ä¸­çš„ this é—®é¢˜ï¼Ÿ](#18--å¦‚ä½•å¤„ç†ç±»ä¸­çš„-this-é—®é¢˜)

<!-- endregion:toc -->

## 1. ğŸ¯ æœ¬èŠ‚å†…å®¹

- todo

## 2. ğŸ«§ è¯„ä»·

- todo

## 3. ğŸ¤” ä»€ä¹ˆæ˜¯ TypeScript ä¸­çš„ç±»ï¼ˆclassï¼‰ï¼Ÿ

ç±»ï¼ˆclassï¼‰æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºæœ¬æ„ä»¶ï¼Œå°è£…äº†å±æ€§å’Œæ–¹æ³•ï¼ŒTypeScript ç»™äºˆäº†å…¨é¢æ”¯æŒã€‚

```ts
class Point {
  x: number
  y: number

  constructor(x: number, y: number) {
    this.x = x
    this.y = y
  }

  add(point: Point) {
    return new Point(this.x + point.x, this.y + point.y)
  }
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­å®šä¹‰äº†ä¸€ä¸ª Point ç±»ï¼ŒåŒ…å«å±æ€§ x å’Œ yï¼Œä»¥åŠæ„é€ å‡½æ•°å’Œ add æ–¹æ³•ã€‚

## 4. ğŸ¤” å¦‚ä½•å£°æ˜ç±»çš„å±æ€§ç±»å‹ï¼Ÿ

ç±»çš„å±æ€§å¯ä»¥åœ¨é¡¶å±‚å£°æ˜ï¼Œä¹Ÿå¯ä»¥åœ¨æ„é€ æ–¹æ³•å†…éƒ¨å£°æ˜ã€‚å¯¹äºé¡¶å±‚å£°æ˜çš„å±æ€§ï¼Œå¯ä»¥åœ¨å£°æ˜æ—¶åŒæ—¶ç»™å‡ºç±»å‹ï¼š

```ts
class Point {
  x: number
  y: number
}
```

å¦‚æœä¸ç»™å‡ºç±»å‹ï¼ŒTypeScript ä¼šè®¤ä¸º x å’Œ y çš„ç±»å‹éƒ½æ˜¯ anyï¼š

```ts
class Point {
  x
  y
}
```

å¦‚æœå£°æ˜æ—¶ç»™å‡ºåˆå€¼ï¼Œå¯ä»¥ä¸å†™ç±»å‹ï¼ŒTypeScript ä¼šè‡ªè¡Œæ¨æ–­å±æ€§çš„ç±»å‹ï¼š

```ts
class Point {
  x = 0
  y = 0
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå±æ€§ x å’Œ y çš„ç±»å‹éƒ½ä¼šè¢«æ¨æ–­ä¸º numberã€‚

## 5. ğŸ¤” TypeScript å¦‚ä½•å¤„ç†æœªåˆå§‹åŒ–çš„ç±»å±æ€§ï¼Ÿ

TypeScript æœ‰ä¸€ä¸ªé…ç½®é¡¹ `strictPropertyInitialization`ï¼Œåªè¦æ‰“å¼€ï¼ˆé»˜è®¤æ˜¯æ‰“å¼€çš„ï¼‰ï¼Œå°±ä¼šæ£€æŸ¥å±æ€§æ˜¯å¦è®¾ç½®äº†åˆå€¼ï¼Œå¦‚æœæ²¡æœ‰å°±æŠ¥é”™ï¼š

```ts
// æ‰“å¼€ strictPropertyInitialization
class Point {
  x: number // æŠ¥é”™
  y: number // æŠ¥é”™
}
```

å¦‚æœä¸å¸Œæœ›å‡ºç°æŠ¥é”™ï¼Œå¯ä»¥ä½¿ç”¨éç©ºæ–­è¨€ï¼š

```ts
class Point {
  x!: number
  y!: number
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œå±æ€§ x å’Œ y æ²¡æœ‰åˆå€¼ï¼Œä½†æ˜¯å±æ€§ååé¢æ·»åŠ äº†æ„Ÿå¹å·ï¼Œè¡¨ç¤ºè¿™ä¸¤ä¸ªå±æ€§è‚¯å®šä¸ä¼šä¸ºç©ºï¼Œæ‰€ä»¥ TypeScript å°±ä¸æŠ¥é”™äº†ã€‚

## 6. ğŸ¤” readonly ä¿®é¥°ç¬¦æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ

å±æ€§åå‰é¢åŠ ä¸Š readonly ä¿®é¥°ç¬¦ï¼Œå°±è¡¨ç¤ºè¯¥å±æ€§æ˜¯åªè¯»çš„ã€‚å®ä¾‹å¯¹è±¡ä¸èƒ½ä¿®æ”¹è¿™ä¸ªå±æ€§ï¼š

```ts
class A {
  readonly id = 'foo'
}

const a = new A()
a.id = 'bar' // æŠ¥é”™
```

readonly å±æ€§çš„åˆå§‹å€¼ï¼Œå¯ä»¥å†™åœ¨é¡¶å±‚å±æ€§ï¼Œä¹Ÿå¯ä»¥å†™åœ¨æ„é€ æ–¹æ³•é‡Œé¢ï¼š

```ts
class A {
  readonly id: string

  constructor() {
    this.id = 'bar' // æ­£ç¡®
  }
}
```

## 7. ğŸ¤” ç±»çš„æ–¹æ³•å¦‚ä½•å£°æ˜ç±»å‹ï¼Ÿ

ç±»çš„æ–¹æ³•å°±æ˜¯æ™®é€šå‡½æ•°ï¼Œç±»å‹å£°æ˜æ–¹å¼ä¸å‡½æ•°ä¸€è‡´ï¼š

```ts
class Point {
  x: number
  y: number

  constructor(x: number, y: number) {
    this.x = x
    this.y = y
  }

  add(point: Point) {
    return new Point(this.x + point.x, this.y + point.y)
  }
}
```

ç±»çš„æ–¹æ³•è·Ÿæ™®é€šå‡½æ•°ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨å‚æ•°é»˜è®¤å€¼ï¼Œä»¥åŠå‡½æ•°é‡è½½ã€‚

## 8. ğŸ¤” ä»€ä¹ˆæ˜¯å­˜å–å™¨æ–¹æ³•ï¼Ÿ

å­˜å–å™¨ï¼ˆaccessorï¼‰æ˜¯ç‰¹æ®Šçš„ç±»æ–¹æ³•ï¼ŒåŒ…æ‹¬å–å€¼å™¨ï¼ˆgetterï¼‰å’Œå­˜å€¼å™¨ï¼ˆsetterï¼‰ä¸¤ç§æ–¹æ³•ï¼š

```ts
class C {
  _name = ''
  get name() {
    return this._name
  }
  set name(value) {
    this._name = value
  }
}
```

å¦‚æœæŸä¸ªå±æ€§åªæœ‰ `get` æ–¹æ³•ï¼Œæ²¡æœ‰ `set` æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥å±æ€§è‡ªåŠ¨æˆä¸ºåªè¯»å±æ€§ï¼š

```ts
class C {
  _name = 'foo'

  get name() {
    return this._name
  }
}

const c = new C()
c.name = 'bar' // æŠ¥é”™
```

## 9. ğŸ¤” å¦‚ä½•ä½¿ç”¨ implements å…³é”®å­—ï¼Ÿ

interface æ¥å£æˆ– type åˆ«åï¼Œå¯ä»¥ç”¨å¯¹è±¡çš„å½¢å¼ï¼Œä¸º class æŒ‡å®šä¸€ç»„æ£€æŸ¥æ¡ä»¶ã€‚ç„¶åï¼Œç±»ä½¿ç”¨ implements å…³é”®å­—ï¼Œè¡¨ç¤ºå½“å‰ç±»æ»¡è¶³è¿™äº›å¤–éƒ¨ç±»å‹æ¡ä»¶çš„é™åˆ¶ï¼š

```ts
interface Country {
  name: string
  capital: string
}

class MyCountry implements Country {
  name = ''
  capital = ''
}
```

ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼ˆå…¶å®æ˜¯æ¥å—å¤šé‡é™åˆ¶ï¼‰ï¼Œæ¯ä¸ªæ¥å£ä¹‹é—´ä½¿ç”¨é€—å·åˆ†éš”ï¼š

```ts
class Car implements MotorVehicle, Flyable, Swimmable {
  // ...
}
```

## 10. ğŸ¤” å¦‚ä½•è·å–ç±»çš„è‡ªèº«ç±»å‹ï¼Ÿ

è¦è·å¾—ä¸€ä¸ªç±»çš„è‡ªèº«ç±»å‹ï¼Œä¸€ä¸ªç®€ä¾¿çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ typeof è¿ç®—ç¬¦ï¼š

```ts
function createPoint(PointClass: typeof Point, x: number, y: number): Point {
  return new PointClass(x, y)
}
```

ç±»çš„è‡ªèº«ç±»å‹å¯ä»¥å†™æˆæ„é€ å‡½æ•°çš„å½¢å¼ï¼š

```ts
function createPoint(
  PointClass: new (x: number, y: number) => Point,
  x: number,
  y: number
): Point {
  return new PointClass(x, y)
}
```

## 11. ğŸ¤” ä»€ä¹ˆæ˜¯ç»“æ„ç±»å‹åŸåˆ™ï¼Ÿ

Class ä¹Ÿéµå¾ª"ç»“æ„ç±»å‹åŸåˆ™"ã€‚ä¸€ä¸ªå¯¹è±¡åªè¦æ»¡è¶³ Class çš„å®ä¾‹ç»“æ„ï¼Œå°±è·Ÿè¯¥ Class å±äºåŒä¸€ä¸ªç±»å‹ï¼š

```ts
class Foo {
  id!: number
}

function fn(arg: Foo) {
  // ...
}

const bar = {
  id: 10,
  amount: 100,
}

fn(bar) // æ­£ç¡®
```

## 12. ğŸ¤” å¦‚ä½•å®ç°ç±»çš„ç»§æ‰¿ï¼Ÿ

ç±»ï¼ˆè¿™é‡Œåˆç§°"å­ç±»"ï¼‰å¯ä»¥ä½¿ç”¨ extends å…³é”®å­—ç»§æ‰¿å¦ä¸€ä¸ªç±»ï¼ˆè¿™é‡Œåˆç§°"åŸºç±»"ï¼‰çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼š

```ts
class A {
  greet() {
    console.log('Hello, world!')
  }
}

class B extends A {}

const b = new B()
b.greet() // "Hello, world!"
```

å­ç±»å¯ä»¥è¦†ç›–åŸºç±»çš„åŒåæ–¹æ³•ï¼š

```ts
class B extends A {
  greet(name?: string) {
    if (name === undefined) {
      super.greet()
    } else {
      console.log(`Hello, ${name}`)
    }
  }
}
```

## 13. ğŸ¤” override å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ

TypeScript 4.3 å¼•å…¥äº† override å…³é”®å­—ï¼Œæ˜ç¡®è¡¨æ˜ä½œè€…çš„æ„å›¾ï¼Œå°±æ˜¯è¦è¦†ç›–çˆ¶ç±»é‡Œé¢çš„åŒåæ–¹æ³•ï¼š

```ts
class B extends A {
  override show() {
    // ...
  }
  override hide() {
    // ...
  }
}
```

TypeScript åˆæä¾›äº†ä¸€ä¸ªç¼–è¯‘å‚æ•° `noImplicitOverride`ã€‚ä¸€æ—¦æ‰“å¼€è¿™ä¸ªå‚æ•°ï¼Œå­ç±»è¦†ç›–çˆ¶ç±»çš„åŒåæ–¹æ³•å°±ä¼šæŠ¥é”™ï¼Œé™¤éä½¿ç”¨äº† override å…³é”®å­—ã€‚

## 14. ğŸ¤” ä»€ä¹ˆæ˜¯å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼Ÿ

ç±»çš„å†…éƒ¨æˆå‘˜çš„å¤–éƒ¨å¯è®¿é—®æ€§ï¼Œç”±ä¸‰ä¸ªå¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼ˆaccess modifiersï¼‰æ§åˆ¶ï¼š`public`ã€`private` å’Œ `protected`ã€‚

`public` ä¿®é¥°ç¬¦è¡¨ç¤ºè¿™æ˜¯å…¬å¼€æˆå‘˜ï¼Œå¤–éƒ¨å¯ä»¥è‡ªç”±è®¿é—®ï¼š

```ts
class Greeter {
  public greet() {
    console.log('hi!')
  }
}
```

`private` ä¿®é¥°ç¬¦è¡¨ç¤ºç§æœ‰æˆå‘˜ï¼Œåªèƒ½ç”¨åœ¨å½“å‰ç±»çš„å†…éƒ¨ï¼š

```ts
class A {
  private x: number = 0
}

const a = new A()
a.x // æŠ¥é”™
```

`protected` ä¿®é¥°ç¬¦è¡¨ç¤ºè¯¥æˆå‘˜æ˜¯ä¿æŠ¤æˆå‘˜ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨ä½¿ç”¨è¯¥æˆå‘˜ï¼Œå®ä¾‹æ— æ³•ä½¿ç”¨è¯¥æˆå‘˜ï¼Œä½†æ˜¯å­ç±»å†…éƒ¨å¯ä»¥ä½¿ç”¨ï¼š

```ts
class A {
  protected x = 1
}

class B extends A {
  getX() {
    return this.x
  }
}
```

## 15. ğŸ¤” å¦‚ä½•ä½¿ç”¨å®ä¾‹å±æ€§çš„ç®€å†™å½¢å¼ï¼Ÿ

å®é™…å¼€å‘ä¸­ï¼Œå¾ˆå¤šå®ä¾‹å±æ€§çš„å€¼ï¼Œæ˜¯é€šè¿‡æ„é€ æ–¹æ³•ä¼ å…¥çš„ã€‚TypeScript æä¾›äº†ä¸€ç§ç®€å†™å½¢å¼ï¼š

```ts
class Point {
  constructor(public x: number, public y: number) {}
}

const p = new Point(10, 10)
p.x // 10
p.y // 10
```

é™¤äº† `public` ä¿®é¥°ç¬¦ï¼Œæ„é€ æ–¹æ³•çš„å‚æ•°ååªè¦æœ‰ `private`ã€`protected`ã€`readonly` ä¿®é¥°ç¬¦ï¼Œéƒ½ä¼šè‡ªåŠ¨å£°æ˜å¯¹åº”ä¿®é¥°ç¬¦çš„å®ä¾‹å±æ€§ã€‚

## 16. ğŸ¤” å¦‚ä½•å¤„ç†ç±»çš„é™æ€æˆå‘˜ï¼Ÿ

ç±»çš„å†…éƒ¨å¯ä»¥ä½¿ç”¨ `static` å…³é”®å­—ï¼Œå®šä¹‰é™æ€æˆå‘˜ã€‚é™æ€æˆå‘˜æ˜¯åªèƒ½é€šè¿‡ç±»æœ¬èº«ä½¿ç”¨çš„æˆå‘˜ï¼Œä¸èƒ½é€šè¿‡å®ä¾‹å¯¹è±¡ä½¿ç”¨ï¼š

```ts
class MyClass {
  static x = 0
  static printX() {
    console.log(MyClass.x)
  }
}

MyClass.x // 0
MyClass.printX() // 0
```

## 17. ğŸ¤” ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»å’ŒæŠ½è±¡æˆå‘˜ï¼Ÿ

TypeScript å…è®¸åœ¨ç±»çš„å®šä¹‰å‰é¢ï¼ŒåŠ ä¸Šå…³é”®å­— `abstract`ï¼Œè¡¨ç¤ºè¯¥ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œåªèƒ½å½“ä½œå…¶ä»–ç±»çš„æ¨¡æ¿ã€‚è¿™ç§ç±»å°±å«åš"æŠ½è±¡ç±»"ï¼ˆabstract classï¼‰ï¼š

```ts
abstract class A {
  id = 1
}

const a = new A() // æŠ¥é”™
```

æŠ½è±¡ç±»çš„å†…éƒ¨å¯ä»¥æœ‰å·²ç»å®ç°å¥½çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æœ‰è¿˜æœªå®ç°çš„å±æ€§å’Œæ–¹æ³•ã€‚åè€…å°±å«åš"æŠ½è±¡æˆå‘˜"ï¼ˆabstract memberï¼‰ï¼š

```ts
abstract class A {
  abstract foo: string
  bar: string = ''
}

class B extends A {
  foo = 'b'
}
```

## 18. ğŸ¤” å¦‚ä½•å¤„ç†ç±»ä¸­çš„ this é—®é¢˜ï¼Ÿ

ç±»çš„æ–¹æ³•ç»å¸¸ç”¨åˆ° `this` å…³é”®å­—ï¼Œå®ƒè¡¨ç¤ºè¯¥æ–¹æ³•å½“å‰æ‰€åœ¨çš„å¯¹è±¡ã€‚TypeScript å…è®¸å‡½æ•°å¢åŠ ä¸€ä¸ªåä¸º `this` çš„å‚æ•°ï¼Œæ”¾åœ¨å‚æ•°åˆ—è¡¨çš„ç¬¬ä¸€ä½ï¼Œç”¨æ¥æè¿°å‡½æ•°å†…éƒ¨çš„ `this` å…³é”®å­—çš„ç±»å‹ï¼š

```ts
class A {
  name = 'A'

  getName(this: A) {
    return this.name
  }
}
```

åœ¨ç±»çš„å†…éƒ¨ï¼Œ`this` æœ¬èº«ä¹Ÿå¯ä»¥å½“ä½œç±»å‹ä½¿ç”¨ï¼Œè¡¨ç¤ºå½“å‰ç±»çš„å®ä¾‹å¯¹è±¡ï¼š

```ts
class Box {
  contents: string = ''

  set(value: string): this {
    this.contents = value
    return this
  }
}
```

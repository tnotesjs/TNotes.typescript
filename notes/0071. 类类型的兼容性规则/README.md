# [0071. ç±»ç±»å‹çš„å…¼å®¹æ€§è§„åˆ™](https://github.com/tnotesjs/TNotes.typescript/tree/main/notes/0071.%20%E7%B1%BB%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%85%BC%E5%AE%B9%E6%80%A7%E8%A7%84%E5%88%99)

<!-- region:toc -->

- [1. ğŸ¯ æœ¬èŠ‚å†…å®¹](#1--æœ¬èŠ‚å†…å®¹)
- [2. ğŸ«§ è¯„ä»·](#2--è¯„ä»·)
- [3. ğŸ” å…¼å®¹æ€§è§„åˆ™é€Ÿè®°è¡¨](#3--å…¼å®¹æ€§è§„åˆ™é€Ÿè®°è¡¨)
- [4. ğŸ¤” å…¬æœ‰æˆå‘˜çš„å…¼å®¹æ€§è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ](#4--å…¬æœ‰æˆå‘˜çš„å…¼å®¹æ€§è§„åˆ™æ˜¯ä»€ä¹ˆ)
- [5. ğŸ¤” ç§æœ‰ã€å—ä¿æŠ¤æˆå‘˜çš„å…¼å®¹æ€§è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ](#5--ç§æœ‰å—ä¿æŠ¤æˆå‘˜çš„å…¼å®¹æ€§è§„åˆ™æ˜¯ä»€ä¹ˆ)
- [6. ğŸ¤” é™æ€æˆå‘˜çš„å…¼å®¹æ€§è§„åˆ™æ˜¯ï¼Ÿ](#6--é™æ€æˆå‘˜çš„å…¼å®¹æ€§è§„åˆ™æ˜¯)
- [7. ğŸ¤” æ„é€ å‡½æ•°ç­¾åçš„å…¼å®¹æ€§æ˜¯ï¼Ÿ](#7--æ„é€ å‡½æ•°ç­¾åçš„å…¼å®¹æ€§æ˜¯)
- [8. ğŸ¤” ç±»å¯ä»¥è·Ÿå¯¹è±¡å­—é¢é‡å…¼å®¹å—ï¼Ÿ](#8--ç±»å¯ä»¥è·Ÿå¯¹è±¡å­—é¢é‡å…¼å®¹å—)

<!-- endregion:toc -->

## 1. ğŸ¯ æœ¬èŠ‚å†…å®¹

- ç±»ç±»å‹çš„å…¼å®¹æ€§è§„åˆ™

## 2. ğŸ«§ è¯„ä»·

ç±»åŒæ—¶å…·å¤‡å¯¹è±¡å’Œå‡½æ•°çš„ç‰¹æ€§ï¼Œæ¯”å¦‚ï¼š

- ç±»çš„æˆå‘˜å±æ€§ - å°±å¥½æ¯”å¯¹è±¡çš„æˆå‘˜å±æ€§
- ç±»çš„æˆå‘˜æ–¹æ³• - å°±å¥½æ¯”å‡½æ•°

å› æ­¤ï¼Œå¯¹ç±»çš„ç±»å‹å…¼å®¹æ€§ä»‹ç»ï¼Œå¯ä»¥é‡ç‚¹çœ‹çœ‹ `å¯¹è±¡ç±»å‹çš„å…¼å®¹æ€§è§„åˆ™`ã€`å‡½æ•°ç±»å‹çš„å…¼å®¹æ€§è§„åˆ™`ï¼Œå®ƒä»¬æœ‰å¾ˆå¤šéƒ½æ˜¯å…±é€šçš„ã€‚

è¯¥ç¬”è®°é‡ç‚¹ä»‹ç»ç±»ä¸­ç‰¹æœ‰çš„ä¸€äº›å…¼å®¹æ€§åˆ¤å®šè§„åˆ™ã€‚

## 3. ğŸ” å…¼å®¹æ€§è§„åˆ™é€Ÿè®°è¡¨

| ç±»å‹ | æ£€æŸ¥è§„åˆ™ | å¤‡æ³¨ |
| --- | --- | --- |
| å…¬æœ‰æˆå‘˜ | ç»“æ„å­ç±»å‹è§„åˆ™ | åå­—ä¸é‡è¦ï¼Œåªçœ‹ç»“æ„ã€‚ |
| ç§æœ‰æˆå‘˜ | å¿…é¡»åŒä¸€ç±»æˆ–å…¶å­ç±» | å°è£…å®‰å…¨ |
| å—ä¿æŠ¤æˆå‘˜ | å¿…é¡»åŒä¸€ç±»æˆ–å…¶å­ç±» | å°è£…å®‰å…¨ |
| é™æ€æˆå‘˜ | æ”¾è¡Œ | éšä¾¿ä»€ä¹ˆç±»å‹éƒ½ OKï¼Œå¯¹å…¼å®¹æ€§æ£€æŸ¥æ— å½±å“ã€‚ |
| æ„é€ å‡½æ•° | æ”¾è¡Œ | å¦‚æœç”¨åˆ°äº† TS æä¾›çš„â€œç±»å‚æ•°å±æ€§çš„è¯­æ³•ç³–â€ï¼Œåˆ™æŒ‰ç…§ç»“æ„å­ç±»å‹è§„åˆ™æ¥å¤„ç†ã€‚ |

## 4. ğŸ¤” å…¬æœ‰æˆå‘˜çš„å…¼å®¹æ€§è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ

èµ°ç»“æ„å­ç±»å‹é‚£ä¸€å¥—ã€‚

::: code-group

```ts [1]
class Point {
  x: number = 1
  y: number = 2
}
class Vector {
  x: number = 3
  y: number = 4
}

// åªå…³æ³¨ç»“æ„ï¼Œä¸å…³æ³¨åå­—ã€‚
let p: Point = new Vector() // âœ… å…¼å®¹
```

```ts [2]
class Point {
  x: number = 1
  y: number = 2
}
class Point3D {
  x: number = 3
  y: number = 4
  z: number = 5
}

let p: Point = new Point()
let p3: Point3D = new Point3D()

// Point3D æœ‰ Point éœ€è¦çš„æ‰€æœ‰æˆå‘˜
p = p3 // âœ… å…¼å®¹

// p3 = p // âŒ ä¸å…¼å®¹
// Property 'z' is missing in type 'Point' but required in type 'Point3D'.(2741)
```

:::

## 5. ğŸ¤” ç§æœ‰ã€å—ä¿æŠ¤æˆå‘˜çš„å…¼å®¹æ€§è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ

ä¸ºäº†é˜²æ­¢ç ´åå°è£…æ€§ï¼ŒTypeScript è¦æ±‚å¦‚æœç±»ä¸­åŒ…å«ç§æœ‰æˆ–å—ä¿æŠ¤æˆå‘˜ï¼Œåˆ™ä¸¤ä¸ªç±»å®ä¾‹çš„ç±»å‹åªæœ‰åœ¨å®ƒä»¬æ¥è‡ªåŒä¸€ä¸ªç±»å£°æ˜æˆ–å…¶å­ç±»æ—¶æ‰å…¼å®¹ã€‚

::: code-group

```ts [1]
class Animal {
  private name: string
  constructor(name: string) {
    this.name = name
  }
}

class Dog {
  private name: string // å³ä½¿ç»“æ„ç›¸åŒï¼Œä¹Ÿä¸æ˜¯ Animal çš„ç§æœ‰æˆå‘˜
  constructor(name: string) {
    this.name = name
  }
}

let a: Animal = new Dog('Buddy') // âŒ é”™è¯¯ï¼ç§æœ‰æˆå‘˜ä¸å…¼å®¹
// Type 'Dog' is not assignable to type 'Animal'.
//   Types have separate declarations of a private property 'name'.(2322)
```

```ts [2]
// åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰
class Base {
  protected name = 'base'
}
// æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰
class Derived extends Base {
  protected name = 'derived'
}

let base: Base = new Base()
let derived: Derived = new Derived()

// å­ç±»å¯ä»¥èµ‹å€¼ç»™çˆ¶ç±»
base = derived // âœ… å…¼å®¹

// çˆ¶ç±»æ— æ³•èµ‹å€¼ç»™å­ç±»
derived = base // âŒ ä¸å…¼å®¹
// Type 'Base' is not assignable to type 'Derived'.
//   Property 'name' is protected but type 'Base' is not a class derived from 'Derived'.(2322)
```

:::

## 6. ğŸ¤” é™æ€æˆå‘˜çš„å…¼å®¹æ€§è§„åˆ™æ˜¯ï¼Ÿ

é™æ€æˆå‘˜ä¸å‚ä¸ç±»å®ä¾‹çš„å…¼å®¹æ€§æ£€æŸ¥ã€‚

å³ä½¿ä¸¤ä¸ªç±»çš„é™æ€æˆå‘˜å®Œå…¨ä¸åŒï¼Œåªè¦å®ä¾‹æˆå‘˜å…¼å®¹ï¼Œä¹Ÿå¯ä»¥èµ‹å€¼ã€‚

```ts
class A {
  static version = 1
  static readonly name_a = 'A'
}
class B {
  static readonly version: 'v1' = 'v1'
  static name_b = undefined
}

let b: B = new B()
let a: A = new A()

// ä¸ä¼šæ£€æŸ¥é™æ€æˆå‘˜
a = b // âœ… OK
b = a // âœ… OK
```

## 7. ğŸ¤” æ„é€ å‡½æ•°ç­¾åçš„å…¼å®¹æ€§æ˜¯ï¼Ÿ

å¾—çœ‹å…·ä½“æƒ…å†µï¼š

1. é€šå¸¸æƒ…å†µï¼šç±»çš„æ„é€ å‡½æ•°ï¼ˆå³ç±»ç±»å‹çš„â€œæ„é€ ç­¾åâ€ï¼‰åœ¨æ¯”è¾ƒæ—¶ï¼Œä¸ä¼šè¿›è¡Œç±»å‹æ£€æŸ¥ï¼›
2. ç‰¹æ®Šæƒ…å†µï¼šåœ¨æ„é€ å‡½æ•°å‚æ•°ä¸­ä½¿ç”¨äº†å‚æ•°å±æ€§çš„ç®€å†™ï¼Œä¼šæŒ‰ç…§ç»“æ„å­ç±»å‹è§„åˆ™æ¥æ£€æŸ¥ï¼›

::: code-group

```ts [1]
class A {
  constructor(x: number) {}
}
class B {
  constructor(x: number, y: number, z?: readonly string[]) {}
}

let a = new A(1)
let b = new B(1, 2, ['1', '2', '3'])

a = b // âœ… å…¼å®¹
b = a // âœ… å…¼å®¹
```

```ts [2]
// å‚æ•°å±æ€§çš„ç®€å†™è¯­æ³•ç³–ï¼š
class A {
  constructor(public x: number) {}
}
class B {
  constructor(public x: number, public y: number) {}
}

// å¦‚æœä½ çœ‹ä¸æ‡‚ä¸Šè¿°çš„è¯­æ³•ç³–å½¢å¼ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢çš„ç­‰æ•ˆå†™æ³•ï¼š
// ç­‰æ•ˆå†™æ³•ï¼š
// class A {
//   x: number

//   constructor( x: number) {
//     this.x = x
//   }
// }
// class B {
//   x: number
//   y: number

//   constructor( x: number,  y: number) {
//     this.x = x
//     this.y = y
//   }
// }

let a = new A(1)
let b = new B(1, 2)

a = b // âœ… å…¼å®¹ - a è¦çš„ï¼Œb éƒ½æœ‰
// b = a // âŒ ä¸å…¼å®¹ - a æ²¡æœ‰ b è¦çš„ y
// Property 'y' is missing in type 'A' but required in type 'B'.(2741)
```

:::

## 8. ğŸ¤” ç±»å¯ä»¥è·Ÿå¯¹è±¡å­—é¢é‡å…¼å®¹å—ï¼Ÿ

å¯ä»¥ï¼Œåªè¦ç»“æ„åŒ¹é…å°±è¡Œã€‚

```ts
class Point {
  x = 1
  y = 2
}

const p: Point = new Point() // âœ… OK

// ä¼šè§¦å‘å¯¹è±¡çš„â€œæ–°é²œåº¦æ£€æŸ¥â€ï¼ˆFreshness Checkingï¼‰è§„åˆ™ï¼šè¦æ±‚ç»“æ„å¿…é¡»å®Œå…¨ä¸€è‡´
// const p1: Point = { x: 1, y: 2, z: 3 } // âŒ æŠ¥é”™
// Object literal may only specify known properties, and 'z' does not exist in type 'Point'.(2353)

// é¿å¼€ Freshness Checking è§„åˆ™ï¼š
const p2 = { x: 1, y: 2, z: 3 }
const p3: Point = p2

// ä¼šè§¦å‘å¯¹è±¡çš„â€œæ–°é²œåº¦æ£€æŸ¥â€ï¼ˆFreshness Checkingï¼‰è§„åˆ™ï¼šè¦æ±‚ç»“æ„å¿…é¡»å®Œå…¨ä¸€è‡´
const p4: Point = { x: 1, y: 2 } // âœ… OK
```

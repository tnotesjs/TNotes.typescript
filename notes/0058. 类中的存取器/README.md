# [0058. ç±»ä¸­çš„å­˜å–å™¨](https://github.com/tnotesjs/TNotes.typescript/tree/main/notes/0058.%20%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%AD%98%E5%8F%96%E5%99%A8)

<!-- region:toc -->

- [1. ğŸ¯ æœ¬èŠ‚å†…å®¹](#1--æœ¬èŠ‚å†…å®¹)
- [2. ğŸ«§ è¯„ä»·](#2--è¯„ä»·)
- [3. ğŸ¤” â€œå­˜å–å™¨ accessorâ€æ˜¯ä»€ä¹ˆï¼Ÿ](#3--å­˜å–å™¨-accessoræ˜¯ä»€ä¹ˆ)
  - [3.1. Getterï¼ˆå–å€¼å™¨ï¼‰](#31-getterå–å€¼å™¨)
  - [3.2. Setterï¼ˆå­˜å€¼å™¨ï¼‰](#32-setterå­˜å€¼å™¨)
  - [3.3. ä¸»è¦ç‰¹ç‚¹](#33-ä¸»è¦ç‰¹ç‚¹)
- [4. ğŸ¤” accessor æ˜¯ TS ä¸­ç‰¹æœ‰çš„å—ï¼Ÿ](#4--accessor-æ˜¯-ts-ä¸­ç‰¹æœ‰çš„å—)
  - [4.1. JavaScript ä¸­çš„ accessor](#41-javascript-ä¸­çš„-accessor)
  - [4.2. JavaScript ç¤ºä¾‹](#42-javascript-ç¤ºä¾‹)
  - [4.3. TypeScript çš„å¢å¼º](#43-typescript-çš„å¢å¼º)
- [5. ğŸ¤” accessor æœ¬è´¨ä¸Šå®šä¹‰çš„æ˜¯ç±»çš„å±æ€§è¿˜æ˜¯ç±»çš„æ–¹æ³•ï¼Ÿ](#5--accessor-æœ¬è´¨ä¸Šå®šä¹‰çš„æ˜¯ç±»çš„å±æ€§è¿˜æ˜¯ç±»çš„æ–¹æ³•)
- [6. ğŸ¤” accessor å¯¹åº”çš„å±æ€§å‘½åå»ºè®®æ˜¯ï¼Ÿ](#6--accessor-å¯¹åº”çš„å±æ€§å‘½åå»ºè®®æ˜¯)
  - [6.1. å‘½åå»ºè®®](#61-å‘½åå»ºè®®)
  - [6.2. å¸¸è§çš„å› å‘½åå†²çªå¯¼è‡´çš„é”™è¯¯](#62-å¸¸è§çš„å› å‘½åå†²çªå¯¼è‡´çš„é”™è¯¯)
  - [6.3. ç•™æ„ IDE æç¤º](#63-ç•™æ„-ide-æç¤º)
  - [6.4. æ­£ç¡®åšæ³•](#64-æ­£ç¡®åšæ³•)
- [7. ğŸ¤” å¦‚ä½•ä½¿ç”¨ accessor å®šä¹‰åªè¯»å±æ€§ï¼Ÿ](#7--å¦‚ä½•ä½¿ç”¨-accessor-å®šä¹‰åªè¯»å±æ€§)
- [8. ğŸ¤” getter å’Œ setter çš„å®é™…åº”ç”¨åœºæ™¯éƒ½æœ‰å“ªäº›ï¼Ÿ](#8--getter-å’Œ-setter-çš„å®é™…åº”ç”¨åœºæ™¯éƒ½æœ‰å“ªäº›)

<!-- endregion:toc -->

## 1. ğŸ¯ æœ¬èŠ‚å†…å®¹

- accessor
- getter
- setter

## 2. ğŸ«§ è¯„ä»·

- ä½¿ç”¨çš„ accessor çš„æ—¶å€™éœ€è¦æ³¨æ„åç§°ä¸è¦è·Ÿå±æ€§åé‡å ï¼Œå¯¼è‡´é€’å½’é”™è¯¯ã€‚
- accessor æ˜¯ä¸€ç§ç‰¹æ®Šçš„å±æ€§å®šä¹‰æ–¹å¼ï¼Œæä¾›äº†å¯¹å±æ€§è®¿é—®å’Œè®¾ç½®çš„æ§åˆ¶èƒ½åŠ›ã€‚

## 3. ğŸ¤” â€œå­˜å–å™¨ accessorâ€æ˜¯ä»€ä¹ˆï¼Ÿ

å­˜å–å™¨ï¼ˆaccessorï¼‰æ˜¯ç±»ä¸­çš„ä¸€ç§ç‰¹æ®Šè¯­æ³•ï¼Œç”¨äºæ§åˆ¶å¯¹å¯¹è±¡å±æ€§çš„è®¿é—®ï¼Œå®ƒæä¾›äº†ä¸€ç§ä¼˜é›…çš„æ–¹å¼æ¥æ§åˆ¶ç±»å±æ€§çš„è®¿é—®å’Œä¿®æ”¹ï¼Œå¢å¼ºäº†ä»£ç çš„å°è£…æ€§å’Œå®‰å…¨æ€§ã€‚

å®ƒåŒ…æ‹¬ä¸¤ç§ç±»å‹çš„æ–¹æ³•ï¼š

### 3.1. Getterï¼ˆå–å€¼å™¨ï¼‰

- ä½¿ç”¨ `get` å…³é”®å­—å®šä¹‰
- å½“è¯»å–å±æ€§å€¼æ—¶è‡ªåŠ¨è°ƒç”¨
- ç”¨äºå®šä¹‰å¦‚ä½•è·å–å±æ€§å€¼çš„é€»è¾‘

### 3.2. Setterï¼ˆå­˜å€¼å™¨ï¼‰

- ä½¿ç”¨ `set` å…³é”®å­—å®šä¹‰
- å½“è®¾ç½®å±æ€§å€¼æ—¶è‡ªåŠ¨è°ƒç”¨
- ç”¨äºå®šä¹‰å¦‚ä½•è®¾ç½®å±æ€§å€¼çš„é€»è¾‘

```ts
class C {
  _name = ''

  // Getter - å®šä¹‰å¦‚ä½•è·å– name å±æ€§çš„å€¼
  get name() {
    return this._name
  }

  // Setter - å®šä¹‰å¦‚ä½•è®¾ç½® name å±æ€§çš„å€¼
  set name(value) {
    this._name = value
  }
}

const c = new C()
c.name = 'Tom' // è°ƒç”¨ setter
console.log(c.name) // è°ƒç”¨ getterï¼Œè¾“å‡º 'Tom'
```

### 3.3. ä¸»è¦ç‰¹ç‚¹

- å°è£…æ€§ï¼šå¯ä»¥éšè—å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œé€šè¿‡å­˜å–å™¨æš´éœ²å—æ§çš„æ¥å£
- è®¡ç®—å±æ€§ï¼šgetter å¯ä»¥è¿”å›åŸºäºå…¶ä»–å±æ€§è®¡ç®—å¾—å‡ºçš„å€¼
- æ•°æ®éªŒè¯ï¼šsetter å¯ä»¥åœ¨è®¾ç½®å€¼æ—¶è¿›è¡ŒéªŒè¯å’Œå¤„ç†
- åªè¯»å±æ€§ï¼šåªæœ‰ getter æ²¡æœ‰ setter çš„å±æ€§è‡ªåŠ¨æˆä¸ºåªè¯»å±æ€§

## 4. ğŸ¤” accessor æ˜¯ TS ä¸­ç‰¹æœ‰çš„å—ï¼Ÿ

ä¸æ˜¯çš„ï¼Œaccessorï¼ˆå­˜å–å™¨ï¼‰å¹¶ä¸æ˜¯ TypeScript ç‰¹æœ‰çš„ç‰¹æ€§ã€‚

### 4.1. JavaScript ä¸­çš„ accessor

å­˜å–å™¨ï¼ˆgetter/setterï¼‰å®é™…ä¸Šæ˜¯ ECMAScript 5 (ES5) ä¸­å°±å¼•å…¥çš„æ ‡å‡†ç‰¹æ€§ï¼Œè¿™æ„å‘³ç€ï¼š

1. JavaScript åŸç”Ÿæ”¯æŒï¼šä» ES5 å¼€å§‹ï¼ŒJavaScript å°±æ”¯æŒ getter å’Œ setter è¯­æ³•
2. æµè§ˆå™¨å…¼å®¹æ€§ï¼šç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒè¿™ä¸€ç‰¹æ€§
3. TypeScript åªæ˜¯ç±»å‹å¢å¼ºï¼šTypeScript åœ¨ JavaScript åŸºç¡€ä¸Šå¢åŠ äº†ç±»å‹æ£€æŸ¥å’Œæ›´å¥½çš„å¼€å‘ä½“éªŒ

### 4.2. JavaScript ç¤ºä¾‹

```js
// çº¯ JavaScript ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ accessor
class C {
  _name = ''

  get name() {
    return this._name
  }

  set name(value) {
    this._name = value
  }
}

const c = new C()
c.name = 'Tom'
console.log(c.name) // 'Tom'
```

### 4.3. TypeScript çš„å¢å¼º

TypeScript åœ¨åŸç”Ÿ accessor åŸºç¡€ä¸Šæä¾›äº†ï¼š

- ç±»å‹æ£€æŸ¥ï¼šå¯ä»¥ä¸º getter å’Œ setter æŒ‡å®šæ˜ç¡®çš„ç±»å‹
- ç¼–è¯‘æ—¶é”™è¯¯æ£€æµ‹ï¼šå¦‚å±æ€§åå†²çªç­‰é”™è¯¯å¯ä»¥åœ¨ç¼–è¯‘æ—¶å‘ç°
- æ›´å¥½çš„ IDE æ”¯æŒï¼šæä¾›æ›´æ™ºèƒ½çš„ä»£ç æç¤ºå’Œé”™è¯¯æç¤º

```ts
class C {
  _name: string = ''

  get name(): string {
    // TypeScript æ·»åŠ äº†è¿”å›å€¼ç±»å‹
    return this._name
  }

  set name(value: string) {
    // TypeScript æ·»åŠ äº†å‚æ•°ç±»å‹
    this._name = value
  }
}
```

æ‰€ä»¥ accessor æ˜¯ JavaScript çš„æ ‡å‡†ç‰¹æ€§ï¼ŒTypeScript åªæ˜¯åœ¨æ­¤åŸºç¡€ä¸Šæä¾›äº†æ›´å¼ºçš„ç±»å‹å®‰å…¨å’Œå¼€å‘å·¥å…·æ”¯æŒã€‚

## 5. ğŸ¤” accessor æœ¬è´¨ä¸Šå®šä¹‰çš„æ˜¯ç±»çš„å±æ€§è¿˜æ˜¯ç±»çš„æ–¹æ³•ï¼Ÿ

accessorï¼ˆå­˜å–å™¨ï¼‰æœ¬è´¨ä¸Šå®šä¹‰çš„æ˜¯ç±»çš„å±æ€§ï¼Œè€Œä¸æ˜¯æ–¹æ³•ã€‚

è™½ç„¶ accessor ä½¿ç”¨äº† `get` å’Œ `set` å…³é”®å­—ï¼Œçœ‹èµ·æ¥åƒæ˜¯æ–¹æ³•å®šä¹‰ï¼Œä½†å®ƒä»¬å®é™…ä¸Šåˆ›å»ºçš„æ˜¯å±æ€§è®¿é—®å™¨ï¼š

```ts
class C {
  _name = ''

  // è¿™äº›æ˜¯å±æ€§è®¿é—®å™¨ï¼Œä¸æ˜¯æ–¹æ³•
  get name() {
    return this._name
  }

  set name(value) {
    this._name = value
  }
}

const c = new C()

// åƒå±æ€§ä¸€æ ·ä½¿ç”¨ï¼Œä¸éœ€è¦æ‹¬å·
console.log(c.name) // è¯»å–å±æ€§
c.name = 'Tom' // è®¾ç½®å±æ€§

// ä¸åƒæ–¹æ³•é‚£æ ·è°ƒç”¨
// c.name()            // âŒ é”™è¯¯ï¼name ä¸æ˜¯æ–¹æ³•
// c.name('Tom')       // âŒ é”™è¯¯ï¼name ä¸æ˜¯æ–¹æ³•
```

ä¸æ™®é€šæ–¹æ³•çš„åŒºåˆ«ï¼š

```ts
class Example {
  // accessor å±æ€§
  get computedValue() {
    return 'computed'
  }

  // æ™®é€šæ–¹æ³•
  getValue() {
    return 'method result'
  }
}

const ex = new Example()

// accessor åƒå±æ€§ä¸€æ ·ä½¿ç”¨
console.log(ex.computedValue) // 'computed'

// æ™®é€šæ–¹æ³•éœ€è¦è°ƒç”¨
console.log(ex.getValue()) // 'method result'
```

ç»¼ä¸Šï¼Œaccessor æ˜¯ä¸€ç§ç‰¹æ®Šçš„å±æ€§å®šä¹‰æ–¹å¼ï¼Œæä¾›äº†å¯¹å±æ€§è®¿é—®å’Œè®¾ç½®çš„æ§åˆ¶èƒ½åŠ›ï¼Œä½†æœ¬è´¨ä¸Šä»ç„¶æ˜¯å±æ€§è€Œéæ–¹æ³•ã€‚

## 6. ğŸ¤” accessor å¯¹åº”çš„å±æ€§å‘½åå»ºè®®æ˜¯ï¼Ÿ

### 6.1. å‘½åå»ºè®®

æ¯”å¦‚æˆ‘ä»¬å®šä¹‰çš„ accessor çš„åç§°æ˜¯ `name`ï¼Œé€šå¸¸åœ¨ç±»çš„å†…éƒ¨ï¼Œè¿˜éœ€è¦ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„å±æ€§æ¥ç»´æŠ¤ `name` çš„å€¼ã€‚

å¯ä»¥ç”¨ä¸‹åˆ’çº¿å‰ç¼€ï¼ˆå¦‚ `_name`ï¼‰è¡¨ç¤ºå†…éƒ¨ç§æœ‰å­—æ®µï¼Œç›®çš„æ˜¯ä¸ºäº†é¿å…ä¸ accessor getter/setter åç§° `name` å†²çªã€‚

```ts
class C {
  _name = ''

  get name() {
    return this._name
  }
  set name(value) {
    this._name = value
  }
}
```

### 6.2. å¸¸è§çš„å› å‘½åå†²çªå¯¼è‡´çš„é”™è¯¯

å¦‚æœå°† `_name` å†™æˆ `name` ä¼šå¯¼è‡´æ— é™é€’å½’è°ƒç”¨ï¼Œæœ€ç»ˆå¯¼è‡´æ ˆæº¢å‡ºé”™è¯¯ã€‚

```ts
class C {
  name = '' // âŒ é”™è¯¯ï¼šä¸ getter/setter åŒå

  get name() {
    return this.name // è¿™é‡Œä¼šè°ƒç”¨ get name() è‡ªèº«
  }

  set name(value) {
    this.name = value // è¿™é‡Œä¼šè°ƒç”¨ set name() è‡ªèº«
  }
}

const c = new C()
console.log(c.name)
// [ERR]: Maximum call stack size exceeded
```

1. Getter æ— é™é€’å½’ï¼š
   - å½“è®¿é—® `this.name` æ—¶ï¼Œä¼šè°ƒç”¨ `get name()`
   - åœ¨ `get name()` å†…éƒ¨è®¿é—® `this.name`ï¼Œåˆä¼šå†æ¬¡è°ƒç”¨ `get name()`
   - å½¢æˆæ— é™é€’å½’å¾ªç¯
2. Setter æ— é™é€’å½’ï¼š
   - å½“ç»™ `this.name` èµ‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨ `set name(value)`
   - åœ¨ `set name()` å†…éƒ¨ç»™ `this.name` èµ‹å€¼ï¼Œåˆä¼šå†æ¬¡è°ƒç”¨ `set name()`
   - å½¢æˆæ— é™é€’å½’å¾ªç¯

è¿è¡Œæ—¶è¡¨ç°ï¼šå½“å‘ç”Ÿè¿™ç§é€’å½’è°ƒç”¨æ—¶ï¼Œç¨‹åºä¼šæŠ›å‡ºé”™è¯¯ `RangeError: Maximum call stack size exceeded`ã€‚

### 6.3. ç•™æ„ IDE æç¤º

![å›¾ 0](https://cdn.jsdelivr.net/gh/tnotesjs/imgs@main/2025-10-26-08-38-05.png)

å¯¹äºä¸Šè¿°é”™è¯¯ä½¿ç”¨çš„æƒ…å†µï¼ŒIDE ä¸­çš„ TS è¯­è¨€æœåŠ¡å…¶å®æ˜¯ä¼šåŠæ—¶æç¤ºçš„ã€‚

å› ä¸º accessor å®šä¹‰çš„ä¹Ÿæ˜¯å±æ€§ï¼Œå¦‚æœæœ‰å±æ€§åå†²çªï¼Œè¢« TS è¯­è¨€æœåŠ¡æ£€æµ‹å‡ºæ¥åå°±ä¼šç«‹åˆ»æŠ¥é”™ã€‚

å› æ­¤ï¼Œåœ¨å®é™…å¼€å‘ä¸­ä¹Ÿæ— éœ€è¿‡åˆ†æ‹…å¿ƒä¼šè¯¯å†™å±æ€§åå¯¼è‡´é€’å½’é”™è¯¯çš„é—®é¢˜ï¼Œåªéœ€ç•™æ„ IDE çš„é”™è¯¯æç¤ºå³å¯ã€‚

### 6.4. æ­£ç¡®åšæ³•

```ts
// âœ… æ­£ç¡®åšæ³•ï¼šä½¿ç”¨ä¸‹åˆ’çº¿å‰ç¼€åŒºåˆ†
class C {
  _name = '' // ç§æœ‰å­—æ®µ

  get name() {
    return this._name // æ­£ç¡®ï¼šè®¿é—®ç§æœ‰å­—æ®µ
  }

  set name(value) {
    this._name = value // æ­£ç¡®ï¼šè®¾ç½®ç§æœ‰å­—æ®µ
  }
}
```

## 7. ğŸ¤” å¦‚ä½•ä½¿ç”¨ accessor å®šä¹‰åªè¯»å±æ€§ï¼Ÿ

å¦‚æœæŸä¸ªå±æ€§åªæœ‰ `get` æ–¹æ³•ï¼Œæ²¡æœ‰ `set` æ–¹æ³•ï¼Œé‚£ä¹ˆè¯¥å±æ€§è‡ªåŠ¨æˆä¸ºåªè¯»å±æ€§ã€‚

```ts
// ä¸‹é¢çš„ _name å±æ€§è¢«å£°æ˜ä¸ºåªè¯»å±æ€§ï¼Œä¸èƒ½ä¿®æ”¹ï¼š
class C2 {
  _name = 'foo'

  get name() {
    return this._name
  }
}

const c = new C2()
c.name = 'bar' // âŒ æŠ¥é”™
// Cannot assign to 'name' because it is a read-only property.(2540)
```

## 8. ğŸ¤” getter å’Œ setter çš„å®é™…åº”ç”¨åœºæ™¯éƒ½æœ‰å“ªäº›ï¼Ÿ

- Getterï¼ˆå–å€¼å™¨ï¼‰
  - å®šä¹‰å½“è¯»å–æŸä¸ªå±æ€§æ—¶æ‰§è¡Œçš„é€»è¾‘ã€‚
  - å¸¸ç”¨äºæš´éœ²åŸºäºå†…éƒ¨çŠ¶æ€è®¡ç®—å¾—å‡ºçš„å€¼ã€‚
- Setterï¼ˆå­˜å€¼å™¨ï¼‰
  - å®šä¹‰å½“ç»™æŸä¸ªå±æ€§èµ‹å€¼æ—¶æ‰§è¡Œçš„é€»è¾‘ã€‚
  - å¯ä»¥åœ¨èµ‹å€¼æ—¶è¿›è¡ŒéªŒè¯ã€æ—¥å¿—è®°å½•ã€è§¦å‘äº‹ä»¶ç­‰ã€‚

::: code-group

```ts [getter]
// æš´éœ²å†…éƒ¨è®¡ç®—å¾—å‡ºçš„ç»“æœï¼š
class Rectangle {
  constructor(private width: number, private height: number) {}

  get area() {
    return this.width * this.height
  }
}

const rect = new Rectangle(4, 5)
console.log(rect.area) // 20
```

```ts [setter]
// åœ¨èµ‹å€¼æ—¶è¿›è¡ŒéªŒè¯ã€æ—¥å¿—è®°å½•ã€è§¦å‘äº‹ä»¶ç­‰ï¼š
class User {
  private _email = ''

  get email() {
    return this._email
  }

  set email(value: string) {
    if (!value.includes('@')) {
      throw new Error('æ— æ•ˆçš„é‚®ç®±æ ¼å¼')
    }
    this._email = value
    console.log(`é‚®ç®±å·²æ›´æ–°ä¸º: ${value}`)
  }
}
```

:::

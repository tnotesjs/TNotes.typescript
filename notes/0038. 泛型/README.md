# [0038. æ³›å‹](https://github.com/tnotesjs/TNotes.typescript/tree/main/notes/0038.%20%E6%B3%9B%E5%9E%8B)

<!-- region:toc -->

- [1. ğŸ¯ æœ¬èŠ‚å†…å®¹](#1--æœ¬èŠ‚å†…å®¹)
- [2. ğŸ«§ è¯„ä»·](#2--è¯„ä»·)
- [3. ğŸ” æ³›å‹é€Ÿè§ˆ](#3--æ³›å‹é€Ÿè§ˆ)
- [4. ğŸ¤” ä»€ä¹ˆæ˜¯"æ³›å‹"ï¼Ÿ](#4--ä»€ä¹ˆæ˜¯æ³›å‹)
  - [4.1. æ ¸å¿ƒæ¦‚å¿µ](#41-æ ¸å¿ƒæ¦‚å¿µ)
  - [4.2. ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ï¼Ÿ](#42-ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹)
  - [4.3. æ³›å‹çš„åŸºæœ¬è¯­æ³•](#43-æ³›å‹çš„åŸºæœ¬è¯­æ³•)
  - [4.4. æ³›å‹çš„ä¼˜åŠ¿](#44-æ³›å‹çš„ä¼˜åŠ¿)
  - [4.5. å¸¸è§çš„æ³›å‹åº”ç”¨åœºæ™¯](#45-å¸¸è§çš„æ³›å‹åº”ç”¨åœºæ™¯)
  - [4.6. æ³›å‹å‘½åçº¦å®š](#46-æ³›å‹å‘½åçº¦å®š)

<!-- endregion:toc -->

## 1. ğŸ¯ æœ¬èŠ‚å†…å®¹

- æ³›å‹

## 2. ğŸ«§ è¯„ä»·

æœ¬èŠ‚ä¸»è¦å¯¹æœ¬ç« æ³›å‹çš„ç›¸å…³å†…å®¹åšä¸€ä¸ªæ±‡æ€»ï¼Œå¯¹æ³›å‹åšä¸€ä¸ªç²—ç•¥çš„åŸºæœ¬ä»‹ç»ï¼Œæœ‰å…³æ³›å‹çš„å…·ä½“ç»†èŠ‚å†…å®¹ï¼Œè§ç›¸å…³ç¬”è®°ã€‚

## 3. ğŸ” æ³›å‹é€Ÿè§ˆ

<N :ids="['0115', '0116', '0117', '0118', '0121', '0122']" />

## 4. ğŸ¤” ä»€ä¹ˆæ˜¯"æ³›å‹"ï¼Ÿ

æ³›å‹ï¼ˆGenericsï¼‰æ˜¯ä¸€ç§å‚æ•°åŒ–ç±»å‹çš„æœºåˆ¶ï¼Œå…è®¸åœ¨å®šä¹‰å‡½æ•°ã€ç±»æˆ–æ¥å£æ—¶ä½¿ç”¨ç±»å‹å‚æ•°ï¼Œä»è€Œåœ¨ä½¿ç”¨æ—¶æ‰æŒ‡å®šå…·ä½“çš„ç±»å‹ã€‚

### 4.1. æ ¸å¿ƒæ¦‚å¿µ

æ³›å‹å°±åƒä¸€ä¸ªâ€œç±»å‹å ä½ç¬¦â€æˆ–â€œç±»å‹å˜é‡â€ï¼Œå®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿç¼–å†™å¯å¤ç”¨çš„ã€ç±»å‹å®‰å…¨çš„ä»£ç ï¼Œè€Œä¸éœ€è¦ä¸ºæ¯ç§æ•°æ®ç±»å‹éƒ½å†™ä¸€éé‡å¤çš„é€»è¾‘ã€‚

### 4.2. ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ï¼Ÿ

åœ¨æ²¡æœ‰æ³›å‹ä¹‹å‰ï¼Œæˆ‘ä»¬é¢ä¸´ä¸¤éš¾çš„é€‰æ‹©ï¼š

1. ä½¿ç”¨ `any` ç±»å‹ï¼šå¤±å»ç±»å‹å®‰å…¨
2. ä¸ºæ¯ç§ç±»å‹ç¼–å†™é‡å¤ä»£ç ï¼šä»£ç å†—ä½™ï¼Œéš¾ä»¥ç»´æŠ¤

æ³›å‹æä¾›äº†ç¬¬ä¸‰ç§é€‰æ‹©ï¼šæ—¢ä¿æŒç±»å‹å®‰å…¨ï¼Œåˆå®ç°ä»£ç å¤ç”¨ã€‚

ç¤ºä¾‹ï¼š

1. ä½¿ç”¨ `any`ï¼ˆç±»å‹ä¸å®‰å…¨ï¼‰
2. é‡å¤ç¼–å†™ä»£ç ï¼ˆä»£ç å†—ä½™ï¼‰
3. ä½¿ç”¨æ³›å‹ï¼ˆæœ€ä½³æ–¹æ¡ˆï¼‰

::: code-group

```ts [1]
// âŒ ä½¿ç”¨ any ç±»å‹
function identity(value: any): any {
  return value
}

const num = identity(42)
const str = identity('hello')

// âš ï¸ å¤±å»ç±»å‹å®‰å…¨
num.toFixed(2) // å¯ä»¥è°ƒç”¨ï¼Œä½†å¦‚æœä¼ å…¥çš„æ˜¯å­—ç¬¦ä¸²å°±ä¼šæŠ¥é”™
str.toUpperCase() // å¯ä»¥è°ƒç”¨ï¼Œä½†å¦‚æœä¼ å…¥çš„æ˜¯æ•°å­—å°±ä¼šæŠ¥é”™
```

```ts [2]
// âŒ ä¸ºæ¯ç§ç±»å‹ç¼–å†™é‡å¤ä»£ç 
function identityNumber(value: number): number {
  return value
}

function identityString(value: string): string {
  return value
}

function identityBoolean(value: boolean): boolean {
  return value
}

// âš ï¸ ä»£ç å†—ä½™ï¼Œéš¾ä»¥ç»´æŠ¤
const num = identityNumber(42)
const str = identityString('hello')
const bool = identityBoolean(true)
```

```ts [3]
// âœ… ä½¿ç”¨æ³›å‹
function identity<T>(value: T): T {
  return value
}

const num = identity(42) // T è¢«æ¨æ–­ä¸º number
const str1 = identity('hello') // T è¢«æ¨æ–­ä¸º "hello"ï¼ˆå¦‚æœæ˜¯ä½¿ç”¨ const å®šä¹‰çš„å˜é‡ï¼ŒTS ä¼šå°†å­—ç¬¦ä¸²æ¨æ–­ä¸ºæ›´åŠ å…·ä½“çš„å­—é¢é‡ç±»å‹ï¼‰
// let str2 = identity('hello') // T è¢«æ¨æ–­ä¸º string
const bool = identity(true) // T è¢«æ¨æ–­ä¸º boolean

// âœ… ç±»å‹å®‰å…¨
num.toFixed(2) // âœ… æ­£ç¡®ï¼Œnum æ˜¯ number ç±»å‹
str1.toUpperCase() // âœ… æ­£ç¡®ï¼Œstr æ˜¯ string ç±»å‹
bool && console.log('yes') // âœ… æ­£ç¡®ï¼Œbool æ˜¯ boolean ç±»å‹
```

:::

### 4.3. æ³›å‹çš„åŸºæœ¬è¯­æ³•

æ³›å‹ä½¿ç”¨å°–æ‹¬å· `<>` æ¥å®šä¹‰ç±»å‹å‚æ•°ï¼Œé€šå¸¸ä½¿ç”¨å•ä¸ªå¤§å†™å­—æ¯å‘½åï¼ˆå¦‚ `T`ã€`K`ã€`V` ç­‰ï¼‰ã€‚

```ts
// æ³›å‹å‡½æ•°
function func<T>(param: T): T {
  return param
}

// æ³›å‹æ¥å£
interface Box<T> {
  value: T
}

// æ³›å‹ç±»
class Container<T> {
  constructor(public value: T) {}
}

// æ³›å‹ç±»å‹åˆ«å
type Pair<T, U> = {
  first: T
  second: U
}
```

### 4.4. æ³›å‹çš„ä¼˜åŠ¿

| ä¼˜åŠ¿     | è¯´æ˜                                      |
| -------- | ----------------------------------------- |
| ç±»å‹å®‰å…¨ | åœ¨ç¼–è¯‘æ—¶æ•è·ç±»å‹é”™è¯¯ï¼Œé¿å…è¿è¡Œæ—¶å¼‚å¸¸      |
| ä»£ç å¤ç”¨ | ä¸€å¥—ä»£ç é€‚ç”¨äºå¤šç§ç±»å‹ï¼Œå‡å°‘é‡å¤          |
| ç±»å‹æ¨æ–­ | TypeScript èƒ½è‡ªåŠ¨æ¨æ–­æ³›å‹å‚æ•°ï¼Œä½¿ç”¨æ›´ä¾¿æ· |
| çµæ´»æ€§   | å¯ä»¥é€šè¿‡æ³›å‹çº¦æŸæ¥é™åˆ¶ç±»å‹å‚æ•°çš„èŒƒå›´      |
| å¯è¯»æ€§   | æ˜ç¡®è¡¨è¾¾ä»£ç æ„å›¾ï¼Œæå‡ä»£ç çš„å¯ç»´æŠ¤æ€§      |

### 4.5. å¸¸è§çš„æ³›å‹åº”ç”¨åœºæ™¯

```ts
// 1. æ•°ç»„æ“ä½œ
function getFirst<T>(arr: T[]): T | undefined {
  return arr[0]
}

const firstNum = getFirst([1, 2, 3]) // number | undefined
const firstName = getFirst(['a', 'b', 'c']) // string | undefined

// 2. Promise å¼‚æ­¥æ“ä½œ
async function fetchData<T>(url: string): Promise<T> {
  const response = await fetch(url)
  return response.json()
}

interface User {
  id: number
  name: string
}

;(async () => {
  const user = await fetchData<User>('/api/user') // user ç±»å‹ä¸º User
  console.log(user)
})()

// 3. æ•°æ®å®¹å™¨
class Stack<T> {
  private items: T[] = []

  push(item: T): void {
    this.items.push(item)
  }

  pop(): T | undefined {
    return this.items.pop()
  }
}

const numberStack = new Stack<number>()
numberStack.push(1)
numberStack.push(2)

const stringStack = new Stack<string>()
stringStack.push('hello')
stringStack.push('world')
```

### 4.6. æ³›å‹å‘½åçº¦å®š

| å‘½å | å«ä¹‰            | ä½¿ç”¨åœºæ™¯           |
| ---- | --------------- | ------------------ |
| `T`  | Typeï¼ˆç±»å‹ï¼‰    | é€šç”¨ç±»å‹å‚æ•°       |
| `K`  | Keyï¼ˆé”®ï¼‰       | å¯¹è±¡é”®ç±»å‹         |
| `V`  | Valueï¼ˆå€¼ï¼‰     | å¯¹è±¡å€¼ç±»å‹         |
| `E`  | Elementï¼ˆå…ƒç´ ï¼‰ | æ•°ç»„æˆ–é›†åˆå…ƒç´ ç±»å‹ |
| `R`  | Resultï¼ˆç»“æœï¼‰  | å‡½æ•°è¿”å›å€¼ç±»å‹     |
| `P`  | Propsï¼ˆå±æ€§ï¼‰   | React ç»„ä»¶å±æ€§ç±»å‹ |
| `S`  | Stateï¼ˆçŠ¶æ€ï¼‰   | React ç»„ä»¶çŠ¶æ€ç±»å‹ |

è™½ç„¶å¯ä»¥ä½¿ç”¨ä»»æ„åç§°ï¼Œä½†éµå¾ªè¿™äº›çº¦å®šå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚
